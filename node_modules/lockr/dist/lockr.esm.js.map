{"version":3,"file":"lockr.esm.js","sources":["../src/prefix.ts","../src/set.ts","../src/smembers.ts","../src/sadd.ts","../src/rm.ts","../src/get.ts","../src/keys.ts","../src/getAll.ts","../src/flush.ts","../src/sismember.ts","../src/srem.ts"],"sourcesContent":["let PREFIX = '';\nexport function setPrefix(prefix: string): string {\n  PREFIX = prefix;\n  return PREFIX;\n}\nexport function getPrefixedKey(key: string, options?: Options): string {\n  if (options?.noPrefix === true) {\n    return key;\n  } else {\n    return `${PREFIX}${key}`;\n  }\n}\n\nexport function hasPrefix(): boolean {\n  return PREFIX.length > 0;\n}\n\nexport function getPrefix(): string {\n  return PREFIX;\n}\n\nexport default getPrefix;\n","import { getPrefixedKey } from './prefix';\n\ntype Options = any;\nexport default function set(key: string, value: any, options?: Options): void {\n  var query_key = getPrefixedKey(key, options);\n\n  try {\n    localStorage.setItem(query_key, JSON.stringify({ data: value }));\n  } catch (e) {\n    if (console) {\n      console.warn(\n        `Lockr didn't successfully save the '{\"${key}\": \"${value}\"}' pair, because the localStorage is full.`\n      );\n    }\n  }\n}\n","import { getPrefixedKey } from './prefix';\nexport default function smembers(key: string, options?: Options): Array<any> {\n  const queryKey = getPrefixedKey(key, options);\n  let value;\n\n  const localValue = localStorage.getItem(queryKey);\n  if (localValue !== null) {\n    value = JSON.parse(localValue);\n  } else {\n    value = null;\n  }\n\n  return value && value.data ? value.data : [];\n}\n","import smembers from './smembers';\nimport { getPrefixedKey } from './prefix';\n\nexport default function sadd(\n  key: string,\n  value: any,\n  options?: Options\n): boolean {\n  const queryKey = getPrefixedKey(key, options);\n  let json;\n\n  var values = smembers(key);\n\n  if (values.indexOf(value) > -1) {\n    return false;\n  }\n\n  try {\n    values.push(value);\n    json = JSON.stringify({ data: values });\n    localStorage.setItem(queryKey, json);\n  } catch (e) {\n    console.log(e);\n    if (console)\n      console.warn(\n        \"Lockr didn't successfully add the \" +\n          value +\n          ' to ' +\n          key +\n          ' set, because the localStorage is full.'\n      );\n  }\n  return true;\n}\n","import { getPrefixedKey } from './prefix';\n\nexport default function rm(key: string, options?: Options): void {\n  const queryKey = getPrefixedKey(key, options);\n\n  return localStorage.removeItem(queryKey);\n}\n","import { getPrefixedKey } from './prefix';\n\nexport default function get(\n  key: string,\n  missing?: any,\n  options?: Options\n): any {\n  const queryKey = getPrefixedKey(key, options);\n  let value;\n\n  const localValue = localStorage.getItem(queryKey);\n  try {\n    if (localValue !== null) {\n      value = JSON.parse(localValue);\n    }\n  } catch (e) {\n    if (localStorage[queryKey]) {\n      value = { data: localStorage.getItem(queryKey) };\n    } else {\n      value = null;\n    }\n  }\n\n  if (!value) {\n    return missing;\n  } else if (typeof value === 'object' && typeof value.data !== 'undefined') {\n    return value.data;\n  }\n}\n","import getPrefix, { hasPrefix } from './prefix';\nexport default function keys() {\n  const prefix = getPrefix();\n  const keys: Array<any> = [];\n  const allKeys = Object.keys(localStorage);\n\n  if (!hasPrefix()) {\n    return allKeys;\n  }\n\n  allKeys.forEach(function(key) {\n    if (key.indexOf(prefix) !== -1) {\n      keys.push(key.replace(prefix, ''));\n    }\n  });\n\n  return keys;\n}\n","import get from './get';\nimport { default as getKeys } from './keys';\n\nexport default function getAll(includeKeys?: boolean) {\n  const keys = getKeys();\n\n  if (includeKeys) {\n    return keys.reduce(function(accum, key) {\n      const tempObj: Index = {};\n      tempObj[key] = get(key);\n      accum.push(tempObj);\n      return accum;\n    }, []);\n  }\n\n  return keys.map(function(key) {\n    return get(key);\n  });\n}\n","import keys from './keys';\nimport PREFIX, { getPrefixedKey } from './prefix';\n\nexport default function flush() {\n  if (PREFIX.length > 0) {\n    keys().forEach(key => {\n      localStorage.removeItem(getPrefixedKey(key));\n    });\n  } else {\n    localStorage.clear();\n  }\n}\n","import smembers from './smembers';\n\nexport default function sismember(key: string, value: any) {\n  return smembers(key).indexOf(value) > -1;\n}\n","import { getPrefixedKey } from './prefix';\nimport smembers from './smembers';\n\nexport default function srem(key: string, value: any, options?: Options) {\n  const queryKey = getPrefixedKey(key, options);\n  const values = smembers(key, value);\n  const index = values.indexOf(value);\n\n  if (index > -1) {\n    values.splice(index, 1);\n  }\n\n  const json = JSON.stringify({ data: values });\n\n  try {\n    localStorage.setItem(queryKey, json);\n  } catch (e) {\n    if (console)\n      console.warn(\n        \"Lockr couldn't remove the \" + value + ' from the set ' + key\n      );\n  }\n}\n"],"names":["PREFIX","setPrefix","prefix","getPrefixedKey","key","options","noPrefix","hasPrefix","length","getPrefix","set","value","query_key","localStorage","setItem","JSON","stringify","data","e","console","warn","smembers","queryKey","localValue","getItem","parse","sadd","json","values","indexOf","push","log","rm","removeItem","get","missing","keys","allKeys","Object","forEach","replace","getAll","includeKeys","getKeys","reduce","accum","tempObj","map","flush","clear","sismember","srem","index","splice"],"mappings":"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"}